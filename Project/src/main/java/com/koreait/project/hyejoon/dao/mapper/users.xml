<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- Spring에서 새로 배우는 스타일 -->
<!-- 파라미터가 두개 이상일 땐 꼭 param1, param2 -->
<mapper namespace="com.koreait.project.hyejoon.dao.UsersDao">
	
	<!-- 로그인 -->
	<select id="usersLogin" resultType="com.koreait.project.dto.UsersDto">
		SELECT *
		  FROM USERS
		 WHERE EMAIL = #{param1}
		   AND PASSWORD = #{param2}
	</select>
	<update id="updateTempPw">
		UPDATE USERS
		   SET PASSWORD = #{param2}
		 WHERE EMAIL = #{param1}
	</update>	
	
	<!-- 회원가입 -->
	<select id="nickCheck" parameterType="String" resultType="int">
		SELECT COUNT(*)
		  FROM USERS
		 WHERE USER_NICKNAME = #{user_nickname}
	</select>
	<select id="emailCheck" parameterType="String" resultType="int">
		SELECT COUNT(*)
		  FROM USERS
		 WHERE EMAIL = #{email}
	</select>
	<insert id="insertJoin" parameterType="com.koreait.project.dto.UsersDto">
		INSERT INTO
		 USERS 
		VALUES (USERS_SEQ.NEXTVAL, #{email}, #{password}, 2, SYSDATE, null, 0, 0, 0, '일반회원가입', #{user_nickname}, '안녕하세요~:D', null, #{birth_year}, #{birth_month}, #{birth_day}, #{location1_no}, #{location2_no})
	</insert>
	<select id="getUserNo" parameterType="String" resultType="int">
		SELECT USER_NO
		  FROM USERS
		 WHERE EMAIL = #{email}
	</select>	
	<insert id="insertExerciseList">
		INSERT INTO USER_INTEREST
		VALUES (USER_INTEREST_SEQ.NEXTVAL, #{param1}, #{param2})
	</insert>
	
	<!-- 마이페이지  -->
	<update id="updateAccount">
		UPDATE USER
		   SET PASSWORD = #{param1},
		   	   USER_NICKNAME = #{param2},
		   	   LOCATION1_NO = #{param3}
		   	   LOCATION2_NO = #{param4}
		 WHERE USER_NO = #{user_no}
	</update>
	<delete id="deleteAccount" parameterType="int">
		DELETE FROM USERS
		 WHERE USER_NO = #{user_no}
	</delete>
</mapper>